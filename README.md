Автор: Банокин Дмитрий Александрович, КБ-61СО
Программа: «AnomalyDetection»
Выполнена в рамках дипломной работы: «Задача обнаружения аномалий»
Научный руководитель: Якимова Ольга Павловна

Аннотация:  
Программное средство решает задачу поиска аномалий в выборках объектов, предоставленных пользователем, то есть задачу обнаружения и описания «ненормального» поведения некоторой выборки объектов по отношению к нормальной модели.
Процесс работы с программой заключается во взаимодействии пользователя с графическим интерфейсом программы и файловой системой операционной системы.
Программа представляет инструментарий для построения и использования статистических и нейросетевых моделей обнаружения аномалий.
Программа реализует алгоритм поиска аномалий на основе быстрого дискретного вейвлет преобразования с использованием статистических критерий Фишера и Кохрана-Кокса для средних значений и дисперсий, а также поддержку работы многослойного персептрона.
Программа реализует некоторые модели искусственных нейронных сетей и алгоритм их обучения.
Программа получает на входе набор объектов, описанных своими числовыми параметрами (дробные числа со знаком) и проверяет, содержит ли указанное пользователем окно обнаружения аномалии (как кратковременные, так и длительные). Результаты поиска выводятся в графическом интерфейсе или в файловую систему по выбору пользователя.

Условия эксплуатации:
* объём ОЗУ не менее 2 Гб;
* операционная система Windows 7 или старше;
* наличие установленной библиотеки .NET Framework от Microsoft версии не ниже 4.8.0.

Использование программного средства:
* запуск программы осуществляется с помощью исполняемого файла «AnomalyDetectionApplication.exe»;
* программа представляет из себя визуальный интерфейс на базе технологии WPF с полями для ввода и кнопками для управления;
* кнопка «Загрузить из файла» открывает «Проводник Windows» и предлагает пользователю выбрать файл с данными для загрузки, обрабатывает его и выводит данные в текстовое поле в соответствии с установленным фильтром;
* блок «Данные для исследования» позволяет получить информацию об исследуемых данных: количество объектов в выборке, количество параметров у каждого из объекта, а также вывести в текстовое поле данные в полном виде или по одному из параметров;
* блок «Статистическая модель» позволяет открыть окно генератора статистических моделей или загрузить из файловой системы готовую статистическую модель;
* генератор статистических моделей позволяет создать и сохранить в файловую систему статистическую модель конкретного типа на основе нормальной выборки с выбранным вейвлетом;
* блок «Нейросетевая модель» позволяет открыть окно генератора нейросетевых моделей или загрузить из файловой системы обученную нейросетевую модель;
* генератор нейросетевых моделей позволяет создать и сохранить в файловую систему модель многослойной полносвязной искусственной нейронной сети выбранного типа с искусственными нейронами выбранного типа и обучить её выбранным методом обучения нейронных сетей с заданными параметрами;
* блок «Обнаружение аномалий» в блоке «Статистическое обнаружение» позволяет выбрать какие алгоритмы обнаружения аномалий и с какой чувствительностью будут применяться;
* кнопки «Искать аномалии» в блоках «Статистическое обнаружение» и «Нейросетевое обнаружение» запускают процесс обнаружения аномалий на основе статистической и нейросетевой моделей, соответственно; 
* результаты обнаружения аномалий выводятся в соответствующие текстовые поля в блоках «Статистическое обнаружение» и «Нейросетевое обнаружение»;
* результаты работы алгоритмов обнаружения могут быть сохранены в файловую систему с помощью кнопок «Сохранить в файл» в блоках «Статистическое обнаружение» и «Нейросетевое обнаружение»;
* переключатели «Отображать объекты» позволяют включить и выключить вывод данные в соответствующие текстовые поля;
* кнопка «Выход» закрывает окно программы;
* сообщения об ошибках выводятся в диалоговом окне, сообщения содержат соответствующие инструкции.

Данные:
* входные данные должны быть представлены в виде текстового файла следующего формата:
	* первая строка содержит названия параметров, разделённых символом «;»,
	* каждый объект выборки находится на новой строке файла и представляется вектором рациональных чисел, элементы которого разделены символом «;».
* данные нормальной выборки для создания статистической модели представлены в виде текстового файла следующего формата:
	* каждый объект выборки находится на новой строке файла и представляется вектором рациональных чисел, элементы которого разделены символом «;».
* данные обучающей и проверочной выборок для создания нейросетевой модели представлены в виде текстового файла следующего формата:
	* каждый объект выборки находится на новой строке файла и представляется вектором рациональных чисел, элементы которого разделены символом «;».
	* в конце каждой строки после описания каждого объекта через символ пробела « » указан вектор рациональных чисел желаемого результата, элементы которого разделены символом «;».
* выходные данные статистического детектора аномалий представляются в виде текстового файла, содержащего произвольные сообщения применённых статистических алгоритмов обнаружения аномалий;
* выходные данные нейросетевого детектора аномалий представляются в виде текстового файла следующего формата:
	* каждый объект выборки находится на новой строке файла и представляется вектором рациональных чисел, элементы которого разделены символом «;».
	* в конце каждой строки после описания каждого объекта через символ пробела « » указан вектор рациональных чисел полученного результата, элементы которого разделены символом «;».
* количество объектов во входных наборах данных влияет на скорость работы программы (5000 объектов ~ 1 с., 20 000 объектов ~ 2 с., 50 000 ~ 4 с.);
* при работе более чем с 500 объектов рекомендуется отключать вывод данных экран для экономии ресурсов;
* данные могут храниться в любой доступной для «Проводника Windows» директории.
 
Среда разработки: Visual Studio 2019.
Используемые языки программирования: C#.
Используемые библиотеки: .NET Framework от Microsoft 4.8.0.
Объём программы: 2 Мб
(исходного текста)

Используемые принципы и алгоритмы решения задач: 
* в качестве алгоритма поиска аномалий был реализован алгоритм на основе быстрого дискретного вейвлет-преобразования;
* были реализованы четыре вейвлет функции: вейвлет Хаара и вейвлеты Добеши 4, 6 и 8;
* были использованы следующие статистические критерии: критерии Фишера для средних значений и дисперсий, критерий Кохрана-Кокса для средних значений;
* была реализована модель искусственного нейрона с сигмоидальной функцией активации;
* была реализована модель искусственной нейронной сети – полносвязный многослойный персептрон;
* был реализован алгоритм обучения искусственных нейронных сетей – алгоритм обратного распространения ошибки. 

Структура программного средства:
* программное средство состоит из двух библиотек: «WaveletAnomalyDetection» и «NeuralNetworkTools», а также графического приложения для ОС Windows «AnomalyDetectionApplication» для работы с ними;
* библиотеки могут быть использованы независимо друг от друга и от графического приложения;
* интерфейс графического приложения разделён на три блока: блок исследуемых данных, блок статистического обнаружения аномалий, блок нейросетевого обнаружения аномалий;
* описание принципов работы с библиотеками, точки входа и сигнатуры методов описаны в соответствующих информационных блоках в коде библиотек.
  
Тестирование:
Программа была протестирована на выборке сетевых подключений из базы KDD99 (http://kdd.ics.uci.edu/databases/kddcup99/kddcup99.html), содержащей атаки типа «отказ в обслуживании», и показала эффективность в 97,56% случаев.
